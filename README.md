# ğŸš— Vue3 Cesium Realtime Tracker
> åŸºäº Vue 3 + TypeScript + Cesium çš„ 3D å®æ—¶è½¦è¾†æ€åŠ¿ç›‘æ§ç³»ç»Ÿ

![Vue](https://img.shields.io/badge/Vue-3.3+-4FC08D?style=flat-square&logo=vue.js)
![TypeScript](https://img.shields.io/badge/TypeScript-5.0+-3178C6?style=flat-square&logo=typescript)
![Cesium](https://img.shields.io/badge/Cesium-1.1+-FABD14?style=flat-square&logo=cesium)
![Pinia](https://img.shields.io/badge/Pinia-2.0+-FFD15C?style=flat-square&logo=pinia)

## ğŸ“– é¡¹ç›®ç®€ä»‹ | Introduction

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ WebGIS å®æ—¶å¯è§†åŒ–å¹³å° Demoã€‚é¡¹ç›®åŸºäº **Vue 3** ç”Ÿæ€æ„å»ºï¼Œåˆ©ç”¨ **CesiumJS** å¼ºå¤§çš„ 3D æ¸²æŸ“èƒ½åŠ›ï¼Œå®ç°äº†å¯¹ç§»åŠ¨ç›®æ ‡çš„å®æ—¶å®šä½ã€è½¨è¿¹å¹³æ»‘è¿½è¸ªåŠæ•°æ®æ€åŠ¿ç›‘æ§ã€‚

æ ¸å¿ƒè‡´åŠ›äºè§£å†³ WebGIS å¼€å‘ä¸­å¸¸è§çš„**é«˜é¢‘æ•°æ®æ¸²æŸ“å¡é¡¿**ã€**3D/2D åæ ‡è”åŠ¨**ä»¥åŠ**æµ·é‡æ•°æ®æ›´æ–°**ç­‰æŠ€æœ¯ç—›ç‚¹ã€‚

### âœ¨ åŠŸèƒ½ç‰¹æ€§

- **ğŸŒ 3D å®æ—¶æ¸²æŸ“**ï¼šåŸºäº Cesium åŠ è½½é«˜ç²¾åº¦æ¨¡å‹ï¼Œæ”¯æŒè½¦è¾†ä½ç½®ã€æœå‘çš„å®æ—¶æ›´æ–°ã€‚
- **ğŸš€ è½¨è¿¹å¹³æ»‘æ’å€¼**ï¼šåˆ©ç”¨ GIS ç®—æ³•æ¶ˆé™¤æ•°æ®ä¼ è¾“å»¶è¿Ÿå¯¼è‡´çš„è·³å˜ï¼Œå®ç°ä¸æ»‘çš„ç§»åŠ¨æ•ˆæœã€‚
- **ğŸ’¬ æ™ºèƒ½æ°”æ³¡è·Ÿéš**ï¼šVue ç»„ä»¶ä¸ 3D åæ ‡ç²¾å‡†åŒæ­¥ï¼Œå®ç° HTML å¼¹çª—è·Ÿéšæ¨¡å‹ç§»åŠ¨ã€‚
- **âš¡ï¸ é«˜æ•ˆæ•°æ® diff**ï¼šåŸºäº WebSocket çš„å¢é‡æ›´æ–°æœºåˆ¶ï¼Œé…åˆ Set/Map ç®—æ³•å¤„ç†è½¦è¾†ä¸Šçº¿/ä¸‹çº¿ã€‚
- **ğŸ¯ äº¤äº’å¼è¿½è¸ª**ï¼šæ”¯æŒä¾§è¾¹æ ç‚¹å‡»åˆ—è¡¨ï¼Œè§†è§’è‡ªåŠ¨é”å®šå¹¶è¿½è¸ªæŒ‡å®šè½¦è¾†ã€‚

---

## ğŸ›  æŠ€æœ¯æ ˆ | Tech Stack

| æ¨¡å— | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
| :--- | :--- | :--- |
| **æ ¸å¿ƒæ¡†æ¶** | Vue 3 (Composition API) | é‡‡ç”¨ Setup è¯­æ³•ç³–ï¼Œé€»è¾‘å¤ç”¨æ€§å¼º |
| **å¼€å‘è¯­è¨€** | TypeScript | ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥ï¼Œä¿è¯ä»£ç å¥å£®æ€§ |
| **3D å¼•æ“** | CesiumJS | å¤„ç†åœ°çƒæ¸²æŸ“ã€åæ ‡è½¬æ¢ã€å®ä½“ç®¡ç† |
| **çŠ¶æ€ç®¡ç†** | Pinia | ç®¡ç†è½¦è¾†åˆ—è¡¨ã€WebSocket è¿æ¥çŠ¶æ€ |
| **é€šä¿¡åè®®** | WebSocket (Native) | å®ç°æœåŠ¡ç«¯åˆ°å®¢æˆ·ç«¯çš„æ¯«ç§’çº§æ¨é€ |
| **UI ç»„ä»¶åº“** | Element Plus | ä¾§è¾¹æ åˆ—è¡¨ä¸ç•Œé¢å¸ƒå±€ |
| **æ„å»ºå·¥å…·** | Vite | æé€Ÿå†·å¯åŠ¨ä¸çƒ­æ›´æ–° |

---

## âš¡ï¸ æ ¸å¿ƒæŠ€æœ¯å®ç°

### 1. è½¦è¾†ç§»åŠ¨å¹³æ»‘æ’å€¼ (Smooth Interpolation)
åç«¯æ¨é€çš„æ•°æ®å¾€å¾€æ˜¯ç¦»æ•£çš„ï¼ˆå¦‚ 1ç§’/æ¬¡ï¼‰ã€‚ç›´æ¥èµ‹å€¼ä¼šå¯¼è‡´è½¦è¾†â€œç¬ç§»â€ã€‚
æœ¬é¡¹ç›®ä½¿ç”¨ Cesium çš„ `SampledPositionProperty` å­˜å‚¨å†å²ä½ç½®ç‚¹ï¼Œå¹¶è®¾ç½® `forwardExtrapolationType` ä¸º `HOLD`ï¼ŒCesium å†…éƒ¨å¼•æ“ä¼šè‡ªåŠ¨æ ¹æ®æ—¶é—´æˆ³è®¡ç®—ä¸­é—´å¸§ï¼Œå®ç°å¦‚ä¸èˆ¬é¡ºæ»‘çš„ç§»åŠ¨è½¨è¿¹ã€‚

### 2. 3D åæ ‡ä¸ DOM ç²¾å‡†æ˜ å°„ (Coordinate Mapping)
ä¸ºäº†è®© Vue ç¼–å†™çš„ HTML æ°”æ³¡èƒ½è´´åˆ 3D ç‰©ä½“ï¼Œé¡¹ç›®ç›‘å¬ `viewer.scene.postRender` æ¸²æŸ“å¾ªç¯äº‹ä»¶ã€‚
æ¯å¸§é€šè¿‡ `SceneTransforms.wgs84ToWindowCoordinates` å°†è½¦è¾†çš„ä¸–ç•Œåæ ‡ï¼ˆCartesian3ï¼‰è½¬æ¢ä¸ºå±å¹•åƒç´ åæ ‡ï¼ˆCanvas X,Yï¼‰ï¼ŒåŠ¨æ€æ›´æ–° DOM çš„ `top/left` å±æ€§ï¼Œå®ç°æ— å»¶è¿Ÿè·Ÿéšã€‚

### 3. é«˜æ•ˆæ•°æ®æ¸…æ´—ç®—æ³• (Diff Algorithm)
å½“é¢ä¸´é«˜é¢‘æ•°æ®æ¨é€æ—¶ï¼Œå¦‚ä½•åˆ¤æ–­â€œè°ä¸Šçº¿äº†ã€è°ä¸‹çº¿äº†â€ï¼Ÿ
- **ä¼˜åŒ–å‰**ï¼šåŒé‡ `for` å¾ªç¯éå†ï¼Œå¤æ‚åº¦ O(nÂ²)ã€‚
- **ä¼˜åŒ–å**ï¼šåˆ©ç”¨ `new Set()` å»ºç«‹ ID ç´¢å¼•ï¼Œç»“åˆ `Map` å­˜å‚¨å®ä½“ã€‚åœ¨ `watch` ä¸­ä»…éœ€ O(n) å¤æ‚åº¦å³å¯å®Œæˆå¢é‡æ›´æ–°ä¸ç¦»çº¿å®ä½“çš„è‡ªåŠ¨æ¸…ç† (Entity Remove)ã€‚

- 

---

## ğŸ’» æœ¬åœ°è¿è¡Œ | Getting Started

### ç¯å¢ƒè¦æ±‚
- Node.js > 16.0
- npm æˆ– yarn

### ç¬¬ä¸€æ­¥ï¼šå…‹éš†é¡¹ç›®
```bash
git clone [https://github.com/YourName/vue3-cesium-tracker.git](https://github.com/YourName/vue3-cesium-tracker.git)
cd vue3-cesium-tracker

### ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–
npm install
# æˆ–è€…
yarn install

###ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨æ¨¡æ‹Ÿåç«¯ (WebSocket Server)
# ç¡®ä¿ 3001 ç«¯å£æœªè¢«å ç”¨
node server/server-ws.js

###ç¬¬å››æ­¥ï¼šå¯åŠ¨å‰ç«¯
npm run dev

src/
â”œâ”€â”€ assets/             # é™æ€èµ„æº (CSS, Images)
â”œâ”€â”€ components/
â”‚   â””â”€â”€ CarPopup.vue    # æ°”æ³¡å¼¹çª—ç»„ä»¶ (UI)
â”œâ”€â”€ hooks/              # (å¯é€‰) é€»è¾‘æŠ½ç¦» Hook
â”œâ”€â”€ store/
â”‚   â””â”€â”€ cesium.ts       # Pinia çŠ¶æ€ç®¡ç† (WSè¿æ¥, æ•°æ®åˆ†å‘)
â”œâ”€â”€ types/              # TS ç±»å‹å®šä¹‰
â”œâ”€â”€ App.vue             # æ ¹ç»„ä»¶ (å¸ƒå±€)
â””â”€â”€ main.ts             # å…¥å£æ–‡ä»¶
